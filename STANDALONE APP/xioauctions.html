<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <title>XioAuctions</title>
    <style>
        *, *::before, *::after {
            box-sizing: content-box;
        }

        html, body {
            margin: 0;
            padding: 0;
            border: 0;
            font: 16px/1.6 'Helvetica';
        }

        html, body, textarea {
            color: #333;
            background-color: #fafafa;
        }

        a {
            color: inherit;
            transition: color 133ms;
        }

        a:hover {
            color: #808080;
        }

        #container {
            margin: 0 auto;
            max-width: 40em;
            padding: 1.6em;
        }

        h1 {
            font-size: 5.06em;
            line-height: 1.28em;
            padding-top: 0.296em;
            margin-bottom: 0.0247em;
        }

        h2 {
            font-size: 3.38em;
            line-height: 1.44em;
            padding-top: 0.389em;
            margin-bottom: 0.0926em;
        }

        h3 {
            font-size: 2.25em;
            line-height: 1.44em;
            padding-top: 0.389em;
            margin-bottom: 0.333em;
        }

        h4 {
            font-size: 1.50em;
            line-height: 1.08em;
            padding-top: 0.208em;
            margin-bottom: 0.875em;
        }

        table {
            margin-top: 1em;
        }

        p, table {
            font-size: 1.00em;
            line-height: 1.63em;
            padding-top: 0.500em;
            margin-bottom: 1.13em;
        }

        .gold {
            color: #d6c150;
            font-weight: bold;
        }

        .silver {
            color: #b8b8b8;
            font-weight: bold;
        }

        .copper {
            color: #9d5d38;
            font-weight: bold;
        }

        @media (prefers-color-scheme: dark) {
            body, html, textarea {
                color: #ccc;
                background-color: #111;
            }
        }
    </style>
</head>
<body>
<div id="container">
    <h1>XioAuctions</h1>
    <label for="addon_input">
        <textarea id="addon_input" placeholder="Enter text here from addon" rows="10" style="resize: none;width: 100%"></textarea>
    </label>
    <pre id="log" title="Logs"></pre>

    <div style="float: right"></div>
    <h2>A quick buck</h2>
    <h3>At most a stack in one basket</h3>
    <div id="quick_buck_diversify"></div>
    <h3>All eggs in one basket</h3>
    <div id="quick_buck"></div>
    <h2><a href="#" id="custom_investment">Custom investment</a></h2>
    <h3>At most a stack in one basket</h3>
    <div id="custom_results_diversify"></div>
    <h3>All eggs in one basket</h3>
    <div id="custom_results"></div>
</div>
</body>
<script id="XioAuctions_Import" type="application/json">{"items":{"168583":"Widowbloom","168586":"Rising Glory","168589":"Marrowroot","169701":"Death Blossom","170554":"Vigil's Torch","171263":"Potion of Soul Purity","171264":"Potion of Shaded Sight","171266":"Potion of the Hidden Spirit","171267":"Spiritual Healing Potion","171268":"Spiritual Mana Potion","171269":"Spiritual Rejuvenation Potion","171270":"Potion of Spectral Agility","171271":"Potion of Hardened Shadows","171272":"Potion of Spiritual Clarity","171273":"Potion of Spectral Intellect","171274":"Potion of Spectral Stamina","171275":"Potion of Spectral Strength","171276":"Spectral Flask of Power","171278":"Spectral Flask of Stamina","171285":"Shadowcore Oil","171286":"Embalmer's Oil","171287":"Ground Death Blossom","171288":"Ground Vigil's Torch","171289":"Ground Widowbloom","171290":"Ground Marrowroot","171291":"Ground Rising Glory","171292":"Ground Nightshade","171301":"Spiritual Anti-Venom","171315":"Nightshade","171349":"Potion of Phantom Fire","171350":"Potion of Divine Awakening","171351":"Potion of Deathly Fixation","171352":"Potion of Empowered Exorcisms","171370":"Potion of Specter Swiftness","171428":"Shadowghast Ingot","172040":"Butterscotch Marinated Ribs","172041":"Spinefin Souffle and Fries","172042":"Surprisingly Palatable Feast","172044":"Cinnamon Bonefish Stew","172045":"Tenebrous Crown Roast Aspic","172046":"Biscuits and Caviar","172047":"Candied Amberjack Cakes","172048":"Meaty Apple Dumplings","172049":"Iridescent Ravioli with Apple Sauce","172050":"Sweet Silvergill Sausages","172051":"Steak a la Mode","172052":"Aethereal Meat","172053":"Tenebrous Ribs","172054":"Raw Seraphic Wing","172055":"Phantasmal Haunch","172056":"Medley of Transplanar Spices","172057":"Inconceivably Aged Vinegar","172058":"Smuggled Azerothian Produce","172059":"Rich Grazer Milk","172061":"Seraph Tenders","172062":"Smothered Shank","172063":"Fried Bonefish","172068":"Pickled Meat Smoothie","172069":"Banana Beef Pudding","173032":"Lost Sole","173033":"Iridescent Amberjack","173034":"Silvergill Pike","173035":"Pocked Bonefish","173036":"Spinefin Piranha","173037":"Elysian Thade","176811":"Potion of Sacrificial Anima","178786":"Lusterwheat Flour","179314":"Creeping Crawler Meat","179315":"Shadowy Shank","180457":"Shadestone","180732":"Rune Etched Vial","183823":"Potion of Unhindered Passing","184090":"Potion of the Psychopomp's Speed"},"recipes":{"171263":{"169701":2,"170554":3,"180732":1},"171264":{"168583":3,"169701":2,"180732":1},"171266":{"168586":3,"169701":2,"180732":1},"171267":{"169701":2,"180732":1},"171268":{"169701":2,"180732":1},"171269":{"171267":1,"171268":1},"171270":{"168583":5,"180732":1},"171271":{"168586":3,"170554":3,"180732":1},"171272":{"170554":5,"180732":1},"171273":{"168589":5,"180732":1},"171274":{"170554":5,"180732":1},"171275":{"168586":5,"180732":1},"171276":{"168583":4,"168586":4,"168589":4,"170554":4,"171315":3,"180732":1},"171278":{"168586":3,"168589":3,"171315":1,"180732":1},"171285":{"169701":2,"180732":1},"171286":{"169701":2,"180732":1},"171287":{"169701":2},"171288":{"170554":2},"171289":{"168583":2},"171290":{"168589":2},"171291":{"168586":2},"171292":{"171315":2},"171301":{"169701":2,"180732":1},"171349":{"168586":3,"168589":3,"180732":1},"171350":{"168586":3,"170554":3,"180732":1},"171351":{"168583":3,"170554":3,"180732":1},"171352":{"168583":3,"168589":3,"180732":1},"171370":{"168589":3,"169701":2,"180732":1},"171428":{"171287":10,"171292":2},"172040":{"172053":3,"172057":1,"172058":1,"172059":1},"172041":{"172057":2,"172058":4,"173033":3,"173036":3},"172042":{"172054":5,"172056":5,"172057":2,"173033":5,"173035":5,"173037":3,"178786":3,"179314":5},"172044":{"172056":1,"172058":1,"173035":3,"178786":1},"172045":{"172053":3,"172056":4,"172059":2,"179314":3},"172046":{"172059":1,"173032":1,"178786":1},"172047":{"172056":2,"172058":2,"173033":3,"173035":3,"178786":2},"172048":{"172058":1,"172059":1,"178786":1,"179315":3},"172049":{"172057":1,"172058":3,"173032":3,"173033":3,"178786":2},"172050":{"172056":3,"173034":3},"172051":{"172054":3,"172056":2,"172057":2,"172059":2,"179315":3},"172061":{"172054":4,"172059":3,"173032":2,"173034":2,"178786":3},"172062":{"172056":2,"172059":2,"173032":2,"173036":2,"178786":2,"179315":4},"172063":{"172056":2,"172057":2,"173032":4,"173035":2,"173036":2,"178786":2},"172068":{"172052":1,"172057":1,"172058":1},"172069":{"172052":3,"172055":3,"172059":3,"178786":3},"176811":{"168583":6,"180732":1},"180457":{"171287":5,"171288":2,"171289":2,"171290":2,"171291":2},"183823":{"168583":1,"168586":1,"168589":1,"170554":1,"180732":1},"184090":{"168586":3,"170554":3,"180732":1}},"vendors":{"172056":5000,"172057":3750,"172058":4500,"172059":4250,"178786":3500,"180732":500},"sell_prices":{"168583":5,"168586":1,"168589":5,"169701":5,"170554":5,"171263":2500,"171264":2500,"171266":2500,"171267":2500,"171268":2500,"171269":2500,"171270":2500,"171271":2500,"171272":2500,"171273":2500,"171274":2500,"171275":2500,"171276":2500,"171278":2500,"171285":2500,"171286":2500,"171287":100,"171288":100,"171289":100,"171290":100,"171291":100,"171292":100,"171301":2500,"171315":5,"171349":2500,"171350":2500,"171351":2500,"171352":2500,"171370":2500,"171428":12500,"172040":1250,"172041":1250,"172042":1250,"172044":1250,"172045":1250,"172046":1250,"172047":1250,"172048":1250,"172049":1250,"172050":1250,"172051":1250,"172052":625,"172053":625,"172054":625,"172055":625,"172061":1250,"172062":1250,"172063":1250,"172068":1250,"172069":1250,"173032":625,"173033":625,"173034":625,"173035":625,"173036":625,"173037":625,"176811":2500,"179314":625,"179315":625,"180457":12500,"183823":2500,"184090":2500},"stack_sizes":{"168583":200,"168586":200,"168589":200,"169701":200,"170554":200,"171263":20,"171264":20,"171266":20,"171267":20,"171268":20,"171269":20,"171270":20,"171271":20,"171272":20,"171273":20,"171274":20,"171275":20,"171276":20,"171278":20,"171285":50,"171286":50,"171287":200,"171288":200,"171289":200,"171290":200,"171291":200,"171292":200,"171301":200,"171315":200,"171349":20,"171350":20,"171351":20,"171352":20,"171370":20,"171428":200,"172040":20,"172041":20,"172042":20,"172044":20,"172045":20,"172046":20,"172047":20,"172048":20,"172049":20,"172050":20,"172051":20,"172052":200,"172053":200,"172054":200,"172055":200,"172061":20,"172062":20,"172063":20,"172068":20,"172069":20,"173032":200,"173033":200,"173034":200,"173035":200,"173036":200,"173037":200,"176811":20,"179314":200,"179315":200,"180457":200,"183823":20,"184090":20}}</script>
<script id="XioAuctions_Addon" type="text/plain">171266,59&940000|359&948800|50&949900|308&950000|1281&1002900|20&1003000|220&1003500|15&1003900|400&1004500|28&1004600|5&1045700|100&1099800|45&1099900|12&1100000|52&1109100|17&1159100|21&1314600|1&1699900|623&1999900|8&3000000000|
172044,1450&150000|60&217700|1323&342100|99&343400|4&3900000000|
179315,32&10100|249&10200|513&10300|150&10400|783&10500|289&10600|42&10700|418&10900|21&11000|303&11200|1&11400|11&11700|143&12100|9439&12500|16&13000|2711&14300|14&17700|8024&19900|6&21700|5026&30500|
171267,785&89800|2963&89900|2293&100000|768&103900|9223&113900|548&115000|41&122000|1975&139900|1456&179900|2871&200000|100&299900|4&3900000000|1&3900003900|
172045,1197&520000|983&530000|877&540000|7&570000|45&579900|900&600000|1099&759900|183&799900|8&3700000000|
172061,184&88000|179&88200|779&88300|102&89100|27&90000|2&100000|30&189700|99&213500|4&3800000000|
171315,292&309100|314&309200|687&309400|1327&309500|6&309600|469&309800|46&309900|2144&310000|6233&316500|46&316700|27&316800|785&316900|123&317000|17145&318000|98&318100|664&318200|97&318300|142&318500|226&318600|164&318900|611&319000|66&319200|208&319400|2&319500|104&320000|368&329000|207&329500|200&329700|200&329800|200&329900|200&330000|223&333800|200&333900|200&338500|202&341600|5945&350000|124&351200|76&351400|245&351800|354&352700|475&354200|98&354500|102&355500|207&356700|456&361200|275&365500|245&366200|236&367200|108&369800|320&379500|245&379900|145&380100|452&380500|278&381500|233&382200|456&384700|5886&389800|400&399800|400&399900|401&401300|3580&439300|11893&440000|200&450000|3373&460000|4200&470000|8521&480000|4202&599900|4882&879800|7120&879900|18621&1499000|4&3600000000|
171268,4419&110000|323&114000|100&121800|1545&154000|2&4900009900|4&5100000000|
172046,70&2400|121&2500|338&5000|9&12100|100&40500|4&2600000000|
172062,96&50000|197&56900|43&57400|1606&57500|2&198000|99&298100|4&3500000000|
170554,4032&248400|5851&248500|826&248900|3603&249000|1086&249500|89&249700|247&249900|1191&250000|2&254000|117&254100|101&254200|4575&254300|69&254400|8211&254500|116&255000|4287&275000|43&280000|6591&299900|5&307400|7986&310000|8233&329200|677&368000|4&2900000000|
168586,9591&260700|138&260900|2206&266000|1409&266300|986&266400|384&270000|3&279500|4136&300900|3144&315000|1000&320000|10886&352600|8952&390000|2092&420000|8709&446300|2800&459300|6&477700|4&2000000000|1&5000000000|
171269,48&153800|8&153900|29&154900|9&164900|25&165000|8&168500|4&169000|1&179000|1&179800|92&190800|11&40000000|100&490000000|8&4300000000|
171285,13525&89900|24&90000|2062&110000|2270&164700|204&165000|2000&199500|4&4250000000|
171428,6942&654000|3608&654400|1867&654500|347&655000|636&655400|1120&655500|127&674000|46&674200|22&674300|44&675300|10&679700|20&40000000|4&3600000000|
171349,4062&1725900|650&1726000|1260&1726500|1494&1736500|150&1739900|20&1740000|483&1891800|1000&1899900|138&1978000|2910&1990900|500&1991400|900&1991600|320&2000400|1&2500000000|4&3500000000|
173032,32&400|143&1800|20&2000|7156&2100|1800&2200|8792&2300|3302&2400|91&2500|4058&3000|3724&3400|654&3700|9&3800|196&3900|2562&4500|10&4800|2490&4900|1207&5000|9082&7700|193&8000|2191&10000|4&4100000000|
171270,493&2147800|217&2147900|1195&2148000|560&2148700|76&2148800|120&2191700|6170&2391700|1180&2541800|551&2542100|716&2552200|194&2572900|100&2888100|231&3588100|8&40000000|20&99000000|60&490000000|5&1490000000|
171286,7259&95000|401&99900|1791&100000|112&107000|1947&146900|1069&147900|108&158000|50&158900|65&175800|4&1490000000|1&2450007000|
171350,65&1570000|10&1590000|28&1600000|1&1607600|11&1651800|95&1672400|5&1757400|4&3700000000|
173033,499&210800|18&211000|81&211100|319&212100|59&212200|322&212500|20&212700|114&212800|471&214900|366&215000|3&220000|73&223900|28&224000|63&224400|8526&225000|25093&226000|1049&226500|64&227000|102&227100|221&227200|64&227300|130&227500|43&228200|40&228700|114&230000|12830&231500|4702&231600|14&231700|6&232200|89&236700|48&239000|18&239400|5000&694400|1000&701100|4&4100000000|
171271,78&59800|149&86700|459&97400|4&4350000000|
171287,440&200000|783&250000|599&379700|237&379800|20&40000000|4&4250000000|
171351,198&2479000|20&2479000|546&2479000|53&2479300|21&2489300|1&2489400|146&6250000|4&4300000000|
173034,194&219900|108&220000|293&230000|28&234400|694&234500|70&235000|2021&240000|19415&245000|88&250000|3947&289900|66&290000|52&294200|9&294400|121&294500|3&295000|46&296800|32&296900|12&297000|44&300000|17&307000|10&307800|2&329900|3&337400|1009&350000|2159&400000|599&557800|1403&607800|4&5800000000|
171272,228&1904900|20&1904900|691&1904900|92&1905000|1036&2105000|4&2205000|4&2206000|93&2206200|192&2206300|2&2236300|2&7433100|4&4300000000|
171288,18&60000|129&70000|7296&75900|230&78000|99&100800|84&116000|530&510400|22&572000|5&1070800|20&40000000|
171352,10&1900000|27&1990000|100&2114900|51&2399900|324&2400000|144&2479900|56&2480000|175&2488900|16&2509000|86&2992800|13&2999000|396&2999100|8&2999300|4&4350000000|
173035,8&97700|31&99900|223&100000|22&110000|261&120000|64&126700|26&130000|3&138500|77&138600|16&139900|499&140000|90&150000|5&152700|38&152800|80&153000|574&153500|168&154000|309&154800|6724&154900|514&158000|14&158900|59&159000|433&169000|23&169400|42&169500|58&170000|62&171000|74&171100|70&172000|11&172100|124&191000|10&192100|11&192500|291&192700|8&192800|8&192900|12&193000|28&193500|23&193800|103&194000|41&194500|29&195600|92&195800|8&203500|2&205500|5&210000|2247&259900|4&4100000000|
171273,8171&1338800|228&1396900|2910&1399900|97&1438100|192&1474800|745&1488800|1567&1503000|3&1892700|1149&1892800|665&1992800|8&40000000|100&400000000|5&4250000000|
171289,405&1000000|1212&2450000|20&40000000|4&4100000000|
173036,3&183300|24&184700|2635&184800|252&185300|49&185500|24&186000|134&186900|650&187000|22&187600|8&187900|82&188000|176&188900|18&189000|100&189500|7452&189700|111&189800|124&189900|141&190000|3&194000|2&196000|6&196500|2&197200|6253&250000|10&270000|2810&296000|8639&299900|28986&300000|5831&350000|7200&359800|5200&359900|8&642000|10&690400|2000&700000|14000&705300|80&150000000|4&3100000000|
171274,132&1190000|2&1199400|29&1199500|2&1199900|13&1200000|5&1258800|8&40000000|4&4000000000|
172052,14&200|142&600|1023&700|14&800|6481&900|218&1100|2&1200|29&1300|112&1400|41&1600|6487&1700|27&1800|171&1900|8255&2000|16&2100|18&2300|8734&2500|215&2800|13&2900|11&3000|197&3200|162&3400|171&3500|30&3700|27&3900|2&4400|77&5000|10&5100|10&5200|126&5300|52&5500|427&6600|24&7000|3&7300|10&8000|6&8900|8&9900|82&10000|29&12400|38&18600|34&18700|41&18800|33&18900|45&19000|48&19500|29&21000|12&22000|39&22100|19&29900|4&4000000000|
172068,148&2400|253&2500|10&11900|12&29000|100&29100|4&4100000000|
171370,73&10000|298&10400|3&10500|22&10600|813&10700|335&10800|45&10900|185&11000|6&11100|39&13000|10&21100|20&23000|272&24800|2&1594200|4&3500000000|
173037,1&293300|10&294200|9&294300|39&294400|20&295000|3&295500|33&295900|29&296000|3477&298900|1&299300|64&299400|93&299900|458&300000|12&324900|1&325000|22&327300|55&327500|53&328800|10&330100|19&337000|327&340000|115&343400|5&346800|3&346900|1&347000|2&347100|18&352100|1046&352200|1400&402200|2451&452200|1503&502200|2&40000000|4&3600000000|
171275,902&1500000|1031&1530000|243&1550000|305&1690000|270&1990000|8&40000000|100&390000000|5&4150000000|
172053,27&384500|250&385900|145&386000|73&386600|310&387700|12593&387800|73&387900|355&388000|115&390000|2&394900|4&395000|27&399900|194&400000|79&408900|26&409000|86&409500|70&409600|162&409700|9&409800|437&409900|31&419800|14&419900|106&420000|45&422300|145&422500|29&423300|141&439700|47&439900|16&440000|3&440100|97&441400|73&441500|107&441700|40&443900|42&444000|4&444700|345&444800|365&450000|48&464800|123&464900|8&465000|12&469000|9&469500|30&470000|3&471800|25&481900|44&486800|6&486900|422&487000|129&487500|25&487900|45&488300|37&488400|4&488500|73&489000|57&489500|17&489800|47&534900|78&579900|1055&580000|3923&599900|510&700000|5&1470000|2&40000000|4&3500000000|
172069,145&20000|59&21000|2950&21800|2046&21900|207&22000|891&24200|532&35400|170&35900|990&50000|99&58700|4&3600000000|
171276,273&5799800|570&5799900|441&5859900|500&5899900|926&5948800|2578&5998800|25&6008800|251&6088800|102&6580000|1094&6699900|480&6700000|55&6988600|140&6998900|20&7499800|100&7946500|818&7998800|1&19500000|1&180000000|40&400000000|2&4250000000|
172054,20&10100|237&10200|999&10300|331&10400|1509&10500|86&10600|123&10700|235&10800|1473&10900|20178&11000|28&11200|59&11300|12&11400|348&11500|102&11600|5&11700|317&11900|229&12000|20&12100|1016&12400|3&13000|13&13300|1&13500|2341&14900|1&16400|2122&90900|4463&100000|4&5000000000|
172055,2&10300|9&10400|156&10900|250&11000|105&11800|64&11900|9&12000|1223&14000|947&14900|59&15000|5&15500|25719&19000|77&19500|106&19600|22&19900|59&20000|45&20900|13&21000|125&21100|1288&21700|94&24000|5717&28400|387&38000|90&39800|254&39900|621&40000|22&40500|71&50500|134&51000|8&58300|20&40000000|4&5100000000|
171278,226&2088800|100&2103800|111&2480800|2&180000000|33&490000000|4&3000000000|
171263,59&32700|341&42700|42&42900|15&43000|63&43500|9&43900|2&44000|10&45700|31&59900|16&60000|2&88000|10&914500|50&926200|50&926600|20&40000000|100&390000000|4&3700000000|
172041,3041&430000|472&450000|1885&470000|400&490000|420&500000|99&631000|4&5800000000|
172063,65&492000|2&492200|99&493400|4&2600000000|
179314,5&73100|123&73300|12&78500|66&78800|98&78900|56&80000|1&85500|86&88000|52&89800|49&89900|30&90000|108&97800|76&103800|116&104800|7&104900|65&105000|27&107900|21&108400|34&108500|44&129700|21&129800|127&130000|152&139900|17&140000|285&142900|27&143000|2&163000|500&163100|2259&173400|4944&500000|2&40000000|
176811,103&2304900|80&2374900|47&2379900|23&2380000|6&2390000|40&2400000|5&2404900|3&40000000|4&2600000000|
171290,27&489900|558&499900|4&528800|211&570000|10&1500000|20&40000000|4&5100000000|
171264,13&180000|309&190000|38&200000|4&3700000000|
172042,9&3280000|670&3298100|6&3500200|100&4405800|45&4998200|4&4100000000|
168589,34843&233500|12&233600|8&233700|29&233800|2444&234000|1255&234400|4&239000|2896&239500|200&239600|418&239700|753&239800|214&239900|4&242500|8&242600|101&249700|119&250000|258&251400|1&254900|6&255000|12899&256300|16&256400|141&256600|14&257600|18&257700|28&257800|30&257900|8&258000|925&258700|22450&259900|4006&278000|2401&303800|34754&317900|2000&323500|8067&420000|4592&558800|2402&664200|4&2600000000|1&5000008400|
169701,10428&35000|491&35600|3922&35700|26016&35800|301&35900|8124&36000|173&36200|115&36400|10&36600|2&38000|48&38200|91&38300|3001&38600|2300&38700|8560&38900|17914&39200|2400&39400|14693&39500|11099&39600|11220&39700|35548&39800|36342&40000|19909&47900|51000&48800|3&60000|493&70000|14633&89900|23846&99900|25&130000|19233&196800|1&305700|4&19740500|4&3600000000|
172049,662&220000|3998&230000|1415&240000|1357&250000|64&266600|18&279900|99&293000|1355&299700|520&300000|4&4000000000|
172048,2935&14000|60&18000|225&31700|4&4200000000|
171291,1161&999900|448&1390000|11&1400000|20&40000000|4&3900000000|
172040,5&159700|21&339700|61&359700|7&359800|54&399800|30&515200|148&733300|4&3800000000|
171292,603&239000|36&259000|2630&800000|20&40000000|4&4150000000|
172051,4758&40000|600&60000|60&67700|1509&229000|4&4350000000|
172047,30&100000|1626&650000|232&668600|9&668800|4&3600000000|
180457,1&17990000|75&18000000|17&18980000|52&18989900|1&18999900|17&19003100|2&19543100|9&19740500|1&19740600|2&19950000|2&19970000|5&19971800|14&21345800|8&22000000|59&30990000|
171301,507&5100|250&55100|4&4000000000|
184090,10&1500000|60&1699300|356&1757400|2&40000000|4&2900000000|
172050,390&89700|213&209700|30&240400|99&251500|4&3900000000|
168583,7639&396700|12507&396800|397&396900|30679&397000|1707&399700|11739&399800|17793&399900|12379&400000|103&404400|17&404500|44&404600|101&404700|68&404800|4224&404900|11153&405000|116641&409700|25168&409800|11&410000|33&419600|28990&419800|20&419900|17&420000|49&430000|1624&448600|235&468900|254&496800|10996&500000|130717&698000|15&866300|4&4000000000|1&5000000000|
183823,81&4040400|41&4245300|275&5614000|20&5615300|17&5624000|58&5624100|44&9999900|2&3899999900|4&3900000000|</script>
<script defer>
    // noinspection SpellCheckingInspection
    (function () {
        /* !@#!@# DO NOT MODIFY THIS LINE !@#!@# */
        const v = JSON.parse(document.querySelector('#XioAuctions_Import').innerHTML);
        window.XioAuctions_ToRun = document.querySelector('#XioAuctions_Addon').innerHTML;

        window.XioAuctions_Names = new Map();
        for (const itemId of Object.keys(v.items)) {
            window.XioAuctions_Names.set(+itemId, v.items[itemId]);
        }

        window.XioAuctions_Ingredients = new Map();
        for (const itemId of Object.keys(v.recipes)) {
            const map = new Map();
            for (const ingredientId of Object.keys(v.recipes[itemId])) {
                map.set(+ingredientId, v.recipes[itemId][ingredientId]);
            }
            window.XioAuctions_Ingredients.set(+itemId, map);
        }

        window.XioAuctions_Vendors = new Map();
        for (const itemId of Object.keys(v.vendors)) {
            window.XioAuctions_Vendors.set(+itemId, v.vendors[itemId]);
        }

        window.XioAuctions_SellPrices = new Map();
        for (const itemId of Object.keys(v.sell_prices)) {
            window.XioAuctions_SellPrices.set(+itemId, v.sell_prices[itemId]);
        }

        window.XioAuctions_StackSizes = new Map();
        for (const itemId of Object.keys(v.stack_sizes)) {
            window.XioAuctions_StackSizes.set(+itemId, v.stack_sizes[itemId]);
        }

        // Shadestone
        window.XioAuctions_Dailies = [180457];
    })();
</script>
<script defer>
    (function () {
        function logStart() {
            document.getElementById('log').innerText = '';
        }

        function log(...texts) {
            document.getElementById('log').innerText +=
                (texts?.map(text => typeof text === 'string' ? text : JSON.stringify(text, null, 1)) || []).join(' ') + '\n';
        }

        function valToGold(val) {
            const copper = val % 100;
            const silver = Math.floor(val / 100) % 100;
            const gold = Math.floor(val / 10000);
            return `${gold}<span class="gold">g</span> ${silver}<span class="silver">s</span> ${copper}<span class="copper">c</span>`;
        }

        function calculate(valueInput) {
            logStart();

            function transform(valueInput) {
                function parse(line) {
                    let [itemId, lines] = line.split(",")
                    return {
                        itemId: +itemId,
                        items: lines.substr(0, lines.length - 1).split("|").map(x => {
                            const [q, c] = x.split("&");
                            return {q: +q, c: +c};
                        }).sort((a, b) => a.c - b.c)
                    }
                }

                const lines = new Map();
                for (const line of valueInput.split("\n")) {
                    const {itemId, items} = parse(line);
                    lines.set(itemId, items);
                }
                return lines;
            }

            /**
             *
             * @param names_map {Map}
             * @param ingredients_map {Map}
             * @param vendors_map {Map}
             * @param sell_map {Map}
             * @param input_data {Map}
             * @param blacklist {number[]}
             */
            function find_max_profit(names_map, ingredients_map, vendors_map, sell_map, input_data, blacklist) {
                const items = [];
                for (const [ingredient_id, ingredients] of ingredients_map.entries()) {
                    if (window.XioAuctions_Dailies.includes(ingredient_id) || blacklist.includes(ingredient_id)) {
                        continue;
                    }
                    let cost = 0;
                    const crafting_source = [];
                    forLoop: for (const [regent_id, regent_quantity] of ingredients.entries()) {
                        if (vendors_map.has(regent_id)) {
                            const crafting_cost = vendors_map.get(regent_id) * regent_quantity;
                            cost += crafting_cost;
                            crafting_source.push({
                                id: regent_id,
                                name: names_map.get(regent_id),
                                cost: vendors_map.get(regent_id),
                                quantity: regent_quantity,
                                total: crafting_cost,
                                source: 'Vendor'
                            });
                        } else if (input_data.has(regent_id)) {
                            const entries = [...input_data.get(regent_id)];
                            let quantityToCalc = regent_quantity;
                            while (quantityToCalc > 0) {
                                const entry = entries.shift();
                                if (entry === undefined) {
                                    log('Not enough in AH for', regent_id);
                                    break forLoop;
                                }
                                const removing = Math.min(quantityToCalc, entry.q);
                                quantityToCalc -= removing;
                                cost += entry.c * removing;
                                crafting_source.push({
                                    id: regent_id,
                                    name: names_map.get(regent_id),
                                    cost: entry.c,
                                    quantity: removing,
                                    total: entry.c * removing,
                                    source: 'AH'
                                })
                            }
                        } else {
                            log('Data not found for', regent_id);
                            break;
                        }
                    }
                    const data = {
                        id: ingredient_id,
                        name: names_map.get(ingredient_id),
                        cost: cost + sell_map.get(ingredient_id),
                        crafting_source,
                        sell: input_data.get(ingredient_id)?.[0].c
                    };
                    data.profit = data.sell * 0.95 - cost;
                    items.push(data);
                }
                items.sort((a, b) => b.profit - a.profit);
                return items;
            }

            function estimate(old_input_data, gold, diversify) {
                function run_once(old_input_data, blacklist) {
                    // duplicate all code
                    const input_data = new Map();
                    for (const [key, value] of old_input_data.entries()) {
                        input_data.set(key, JSON.parse(JSON.stringify(value)));
                    }
                    const results = find_max_profit(XioAuctions_Names, XioAuctions_Ingredients, XioAuctions_Vendors, XioAuctions_SellPrices, input_data, blacklist);
                    const remover = results[0];
                    for (let {id, quantity} of remover.crafting_source) {
                        if (!input_data.has(id)) {
                            continue;
                        }
                        const arr = input_data.get(id);
                        while (arr[0].q <= quantity && quantity > 0) {
                            quantity -= arr[0].q;
                            arr.shift();
                        }
                        arr[0].q -= quantity;
                    }
                    return {remover, input_data};
                }

                function create_groups(to_craft) {
                    const g = {};
                    for (const craft of to_craft) {
                        const k = JSON.stringify(craft);
                        if (g[k] === undefined) {
                            g[k] = 0;
                        }
                        g[k]++;
                    }
                    const result = [];
                    for (const [json, count] of Object.entries(g)) {
                        const ob = JSON.parse(json);
                        ob.quantity = count;
                        result.push(ob);
                    }
                    return result;
                }

                const to_craft = [];
                let id = old_input_data;
                while (gold > 0) {
                    const blacklist =
                        diversify
                            ? create_groups(to_craft).map(x => ({
                                id: x.id,
                                q: x.quantity,
                                ss: XioAuctions_StackSizes.get(x.id)
                            })).filter(x => x.q >= x.ss).map(x => x.id)
                            : XioAuctions_Dailies;
                    const result = run_once(id, blacklist);
                    id = result.input_data;
                    to_craft.push(result.remover);
                    gold -= result.remover.cost;
                }
                to_craft.splice(to_craft.length - 1, 1);
                // group duplicates

                return create_groups(to_craft);
            }

            const lines = transform(valueInput);

            function run_for(gold_amount, diversify) {
                let table = '';
                let resultingFunds = gold_amount;
                for (const estimation of estimate(lines, gold_amount, diversify)) {
                    table += `<tr><td>${estimation.name}</td><td>${valToGold(estimation.cost)}</td><td>${valToGold(estimation.sell)}</td><td>${valToGold(estimation.profit)}</td><td>${estimation.quantity}</td></tr>`;
                    resultingFunds += estimation.profit * estimation.quantity;
                }
                return `<p>(${valToGold(gold_amount)} - 12h)  => ${valToGold(resultingFunds)} (${valToGold(resultingFunds - gold_amount)} total profit)</p>
    <table style="width: 100%;table-layout: fixed;text-align: center">
        <thead>
        <tr>
            <th>Name</th>
            <th>Crafting cost</th>
            <th>Min buyout</th>
            <th>Profit</th>
            <th>Quantity</th>
        </tr>
        </thead>
        <tbody>${table}</tbody>
    </table>`;
            }

            document.querySelector('#quick_buck').innerHTML = '';
            document.querySelector('#quick_buck').innerHTML = run_for(10000000, false);
            document.querySelector('#quick_buck_diversify').innerHTML = '';
            document.querySelector('#quick_buck_diversify').innerHTML = run_for(10000000, true);

            return {
                run_for: (gold, diversify) => run_for(gold, diversify)
            };
        }

        const addonInput = document.getElementById("addon_input");
        const addonInputOnInput = function () {
            window.XioAuctions = calculate(this.value);
            addonInput.hidden = true;
        }
        addonInput.addEventListener("input", addonInputOnInput);
        addonInput.addEventListener("focus", function () {
            addonInput.select();
        })
        document.querySelector('#custom_investment').addEventListener('click', function (e) {
            e.stopPropagation();
            e.preventDefault();
            if (window.XioAuctions) {
                let gold = prompt('Gold?');
                if (gold === null) {
                    return;
                }
                document.querySelector('#custom_results').innerHTML = '';
                document.querySelector('#custom_results').innerHTML = window.XioAuctions.run_for(parseInt(gold, 10) * 10000, false);
                document.querySelector('#custom_results_diversify').innerHTML = '';
                document.querySelector('#custom_results_diversify').innerHTML = window.XioAuctions.run_for(parseInt(gold, 10) * 10000, true);
            }
        })
        addonInput.focus();
        if (window.XioAuctions_ToRun) {
            addonInput.value = window.XioAuctions_ToRun;
            addonInputOnInput.call(addonInput);
        }
    })();
</script>
</html>
